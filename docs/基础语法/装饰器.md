# è£…é¥°å™¨

## åˆ›å»ºdemoç»„ä»¶ï¼ˆæœ‰å‘ï¼‰

ä½¿ç”¨`ng`å‘½ä»¤åˆ›å»ºdemoç»„ä»¶ï¼š`ng g c decorator-demo`ï¼Œ åœ¨æ–°åˆ›å»ºçš„`decorator-demo`ï¼Œåˆ›å»ºä¸€ä¸ªæ–‡ä»¶`demo.ts`å­˜æ”¾å®šä¹‰çš„è£…é¥°å™¨ã€‚

> æ³¨æ„ï¼šæ–°å»ºçš„æ–‡ä»¶åä¸€å®šä¸èƒ½æ˜¯å½“å‰ç›®å½•çš„ç›®å½•åï¼Œä¾‹å¦‚ï¼š`decorator-demo.ts`ã€‚

åˆ›å»ºçš„æ–‡ä»¶ç›®å½•å¦‚ä¸‹ï¼š

```
.
â”œâ”€â”€ decorator-demo
 Â Â  â”œâ”€â”€ decorator-demo.component.html
 Â Â  â”œâ”€â”€ decorator-demo.component.scss
 Â Â  â”œâ”€â”€ decorator-demo.component.ts
 Â Â  â””â”€â”€ demo.ts
```

## å±æ€§è£…é¥°å™¨

å®šä¹‰ä¸€ä¸ªå±æ€§è£…é¥°å™¨`Emoji`ï¼Œè¯¥è£…é¥°å™¨çš„åŠŸèƒ½æ˜¯ç”¨ğŸ˜‚åŒ…è£¹è¢«è£…é¥°çš„å±æ€§ã€‚

demo.tsæ–‡ä»¶ï¼š

```javascript
export function Emoji() {
  return (target: object, key: string) => {
    let val = target[key];

    const getter = () => {
      return val;
    };

    const setter = (value: string) => {
      val = `ğŸ˜‚ ${value} ğŸ˜‚`;
    };

    Object.defineProperty(target, key, {
      get: getter,
      set: setter,
      enumerable: true,
      configurable: true
    });
  };
}
```

decorator-demo.component.tsæ–‡ä»¶ï¼š

```javascript
import { Component } from '@angular/core';
import { Emoji } from "./demo";

@Component({
  selector: 'app-decorator-demo',
  templateUrl: './decorator-demo.component.html',
  styleUrls: ['./decorator-demo.component.scss']
})
export class DecoratorDemoComponent {
  @Emoji() title = 'è£…é¥°å™¨';
}
```

decorator-demo.component.htmlæ–‡ä»¶ï¼š

```html
<h4>{{title}}</h4>
```

## æ–¹æ³•è£…é¥°å™¨

å®šä¹‰ä¸€ä¸ªå¯ä»¥æ¥æ”¶å‚æ•°çš„æ–¹æ³•è£…é¥°å™¨`Confirmable`ï¼Œè¯¥è£…é¥°å™¨çš„åŠŸèƒ½æ˜¯åœ¨è°ƒç”¨å‡½æ•°ä¹‹å‰ï¼Œè§¦å‘ä¸€ä¸‹`window.confirm`ç¡®è®¤æ¡†ã€‚

demo.tsæ–‡ä»¶ï¼š

```javascript
export function Confirmable(message: string) {
  return (target: object, key: string, descriptor: PropertyDescriptor) => {
    const original = descriptor.value;

    descriptor.value = function(...args: any[]) {
      const allow = window.confirm(message);
      if (allow) {
        return original.apply(this, args);
      }

      return null;
    };
  };
}
```

decorator-demo.component.tsæ–‡ä»¶ï¼š

```javascript
import { Component } from '@angular/core';
import { Emoji } from "./demo";

@Component({
  selector: 'app-decorator-demo',
  templateUrl: './decorator-demo.component.html',
  styleUrls: ['./decorator-demo.component.scss']
})
export class DecoratorDemoComponent {
  @Confirmable('ç¡®å®šè¦æ‰“å°å—ï¼Ÿ')
  onClick() {
    console.log('hello world');
  }
}
```

decorator-demo.component.htmlæ–‡ä»¶ï¼š

```html
<button type="button" (click)="onClick()">ç‚¹å‡»æ‰“å°Hello World</button>
```
